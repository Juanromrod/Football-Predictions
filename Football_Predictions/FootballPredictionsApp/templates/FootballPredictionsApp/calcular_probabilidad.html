<!DOCTYPE html>
<html>
<head>
    <title>Calcular Probabilidad</title>
    <script>
        // Movemos las funciones al alcance global
        function mostrarCampoHandicap() {
            document.getElementById('handicap-div').style.display = 'block';
        }

        function ocultarCampoHandicap() {
            document.getElementById('handicap-div').style.display = 'none';
        }
    </script>
</head>
<body>
    <h1>Calcular Probabilidad de Apuesta</h1>
    <form method="post" action="{% url 'calcular_probabilidad' %}">
        {% csrf_token %}
        <label for="equipo">Equipo:</label>
        <input type="text" name="equipo" required><br>

        <label for="pais">País:</label>
        <input type="text" name="pais" required><br>

        <label for="local_visitante">Local o Visitante:</label><br>
        <input onclick="ocultarCampoHandicap()" type="radio" name="local_visitante" value="L" checked> Local<br>
        <input onclick="mostrarCampoHandicap()" type="radio" name="local_visitante" value="V"> Visitante<br>

        <div id="handicap-div" style="display: none;">
            <label for="handicap">Handicap:</label>
            <input type="number" name="handicap" value="2"><br>
        </div>

        <button type="submit">Calcular</button>
    </form>

    {% if probabilidad %}
        <h1>Resultados</h1>
        <h2>Equipo: {{ equipo }}</h2>
        <h3>Resultados (Últimos 10 partidos):</h3>
        <p>Goles anotados: {{ resultados.0.3.0 }} ({{ resultados.0.3.1 }}) || Goles recibidos: {{ resultados.0.4.0 }} ({{ resultados.0.4.1 }})</p>
        <p>Victoria: {{ resultados.0.0 }}%</p>
        <p>Empate: {{ resultados.0.1 }}%</p>
        <p>Derrota: {{ resultados.0.2 }}%</p>

        <h3>Resultados como local (Últimos 10 partidos):</h3>
        <p>Goles anotados: {{ resultados.1.3.0 }} ({{ resultados.1.3.1 }}) || Goles recibidos: {{ resultados.1.4.0 }} ({{ resultados.1.4.1 }})</p>
        <p>Victoria: {{ resultados.1.0 }}%</p>
        <p>Empate: {{ resultados.1.1 }}%</p>
        <p>Derrota: {{ resultados.1.2 }}%</p>

        <h3>Resultados como visitante (Últimos 10 partidos):</h3>
        <p>Goles anotados: {{ resultados.2.3.0 }} ({{ resultados.2.3.1 }}) || Goles recibidos: {{ resultados.2.4.0 }} ({{ resultados.2.4.1 }})</p>
        <p>Victoria: {{ resultados.2.0 }}%</p>
        <p>Empate: {{ resultados.2.1 }}%</p>
        <p>Derrota: {{ resultados.2.2 }}%</p>
        {% if visitante %}
            <p>Probabilidad de Ganar o Empatar (X 2): {{ probabilidad }}%</p>
        {% else %}
            <p>Probabilidad de Ganar o Empatar (1 X): {{ probabilidad }}%</p>
        {% endif %}
        {% if probabilidad_handicap > 0 %}
            <p>Probabilidad con Handicap de +{{handicap}}: {{ probabilidad_handicap }}%</p>
        {% endif %}
    {% endif %}
</body>
</html>