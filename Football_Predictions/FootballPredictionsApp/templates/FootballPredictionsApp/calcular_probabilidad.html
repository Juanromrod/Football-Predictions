{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Calcular Probabilidad</title>
    <script>
        // Movemos las funciones al alcance global
        function mostrarCampoHandicap() {
            document.getElementById('handicap-div').style.display = 'block';
        }

        function ocultarCampoHandicap() {
            document.getElementById('handicap-div').style.display = 'none';
        }
        function selectButton(button) {
            const localButton = document.getElementById('local-btn');
            const visitanteButton = document.getElementById('visitante-btn');
            const localVisitanteField = document.getElementById('local_visitante');

            if (button === 'local') {
                ocultarCampoHandicap()
                localVisitanteField.value = 'Local';
                localButton.classList.add('activel');
                visitanteButton.classList.remove('activev');
                visitanteButton.classList.add('visitante-btn');
            } else if (button === 'visitante') {
                mostrarCampoHandicap()
                localVisitanteField.value = 'Visitante';
                visitanteButton.classList.add('activev');
                localButton.classList.remove('activel');
                localButton.classList.add('local-btn');
            }
        }
    </script>
    <link rel="stylesheet" type="text/css" href="{% static 'css/styles.css' %}">
</head>
<body>
    <h1>Calcular Probabilidad de Apuesta</h1>
    <form method="post" action="{% url 'calcular_probabilidad' %}">
        {% csrf_token %}
        <label for="equipo">Equipo:</label>
        <input type="text" name="equipo" required><br>

        <label for="pais">País:</label>
        <input type="text" name="pais" required><br>
        <div class="button-group">
            <input type="button" id="local-btn" class="activel" onclick="selectButton('local')" value="Local">
            <input type="button" id="visitante-btn" class="visitante-btn" onclick="selectButton('visitante')" value="Visitante">
            <input type="hidden" id="local_visitante" name="local_visitante" value="Local">
        </div>

        <div id="handicap-div" style="display: none;">
            <label for="handicap">Handicap:</label>
            <input type="number" name="handicap" value="2"><br>
        </div>

        <button type="submit">Calcular</button>
    </form>

    {% if probabilidad %}
        <div class="pronostico">
            <h1>PRONOSTICO:</h1>
            {% if visitante %}
                <h2>Gana {{ equipo }} o Empata (X 2): {{ probabilidad }}%</h2>
            {% else %}
                <h2>Gana {{ equipo }} o Empata (1 X): {{ probabilidad }}%</h2>
            {% endif %}
            {% if probabilidad_handicap > 0 %}
                <h2>Probabilidad con Handicap de +{{handicap}}: {{ probabilidad_handicap }}%</h2>
            {% endif %}
            <h1 style="margin-top: 60px;">Resultados (Últimos 10 partidos):</h1>
        </div>
        <div class="resultados">
            <div class="estadisticas">
                <h3>Generales:</h3>
                <p>Goles anotados: {{ resultados.0.3.0 }} ({{ resultados.0.3.1 }})</p>
                <p>Goles recibidos: {{ resultados.0.4.0 }} ({{ resultados.0.4.1 }})</p>
                <p>Victoria: {{ resultados.0.0 }}%</p>
                <p>Empate: {{ resultados.0.1 }}%</p>
                <p>Derrota: {{ resultados.0.2 }}%</p>
            </div>
            <div class="estadisticas">
                <h3>Resultados como local:</h3>
                <p>Goles anotados: {{ resultados.1.3.0 }} ({{ resultados.1.3.1 }})</p>
                <p>Goles recibidos: {{ resultados.1.4.0 }} ({{ resultados.1.4.1 }})</p>
                <p>Victoria: {{ resultados.1.0 }}%</p>
                <p>Empate: {{ resultados.1.1 }}%</p>
                <p>Derrota: {{ resultados.1.2 }}%</p>
            </div>
            <div class="estadisticas">
                <h3>Resultados como visitante:</h3>
                <p>Goles anotados: {{ resultados.2.3.0 }} ({{ resultados.2.3.1 }})</p>
                <p>Goles recibidos: {{ resultados.2.4.0 }} ({{ resultados.2.4.1 }})</p>
                <p>Victoria: {{ resultados.2.0 }}%</p>
                <p>Empate: {{ resultados.2.1 }}%</p>
                <p>Derrota: {{ resultados.2.2 }}%</p>
            </div>
        </div>
    {% else %}
        <h1>No hay resultados {{probabilidad}}</h1>
    {% endif %}
</body>
</html>